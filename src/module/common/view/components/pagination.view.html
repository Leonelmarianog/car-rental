{% extends "common/view/layout/base.view.html" %}

{% block pagination %}

{% if numberOfButtons > pages %}
	{% set numberOfButtons = pages %}
{% endif %}

{% set delta = (numberOfButtons / 2)|round(0, 'floor') %}
{% set visibleRangeStart = activePage - delta %}
{% set visibleRangeEnd = activePage + delta %}

{% if numberOfPages % 2 == 0 %}
	{% set visibleRangeEnd = visibleRangeEnd - 1 %}
{% endif %}

{% if visibleRangeStart < 1 %}
	{% set visibleRangeEnd = visibleRangeEnd - visibleRangeStart + 1 %}
{% endif %}

{% if visibleRangeEnd > pages %}
	{% set visibleRangeStart = visibleRangeStart - visibleRangeEnd + pages %}
{% endif %}

{% if 1 > visibleRangeStart %}
	{% set visibleRangeStart = 1 %}
{% endif %}

{% if pages < visibleRangeEnd %}
	{% set visibleRangeEnd = pages %}
{% endif %}

{% if visibleRangeStart > 2 %}
	{% set hasLess = true %}
{% endif %}

{% if visibleRangeEnd + 1 < pages %}
	{% set hasMore = true %}
{% endif %}

{% for i in range(1, pages + 1) %}
	{% if i >= visibleRangeStart  and i <= visibleRangeEnd %}
		{% if i == visibleRangeStart and visibleRangeStart != 1 %}
			<a href="/car/"class="button pagination__page js-pagination-button" data-page="null">1</a>
			{% if hasLess %}
				<span class="pagination__page">...</span>
			{% endif %}
		{% endif %}
		<a href="/car/{{ i if i > 1 else 'null' }}"class="button{{ ' button--highlight' if i == activePage }} pagination__page js-pagination-button" data-page="{{ i if i > 1 else 'null' }}">{{ i }}</a>
		{% if i == visibleRangeEnd and visibleRangeEnd != pages%}
			{% if hasMore %}
				<span class="pagination__page">...</span>
			{% endif %}
			<a href="/car/"class="button pagination__page js-pagination-button" data-page="{{ pages }}">{{ pages }}</a>
		{% endif %}
	{% endif %}
{% endfor %}

{% endblock %}

